# obeject_detect_base_v1
### comment: 
#### task1: classification image xem ảnh là dog hay cat, sử dụng resnet18 pretrained trên imagenet1000, cái chú ý ở đây đó là vì nó được pretrain trên imagenet1000 nên lớp đầu ra của nó là 1000 lớp, vì vậy khi classification xem là dog hay cat ta cần thay fc của nó thành lớp đầu ra là 2. 
#### task2: nó sẽ bao gồm task 1 thêm 1 head nữa để localization, tức là nó head này sẽ có lớp đầu ra là 4 để có thể lấy x, y, w , h, điểm chú ý ở đây đó là vì task này sẽ có 2 head nên việc tính loss sẽ là tổng loss của 2 head, đối với classification loss sẽ là crossentropyloss, còn đối với localization loss sẽ MSEloss.
#### task3: nó sẽ là nâng cấp của task 2 thay vì chỉ xử lí 1 object thì lúc này nó sẽ xử lí nhiều object ở bài toán này cụ thể là 2 object, điểm thú vị ở đây lúc này ta sẽ vẫn chia 2 head nhưng không phải tách riêng chúng, mà ta vẫn sẽ gộp chúng, ở ver đơn giản này 1 tấm ảnh sẽ được chia làm 4 patch, với mỗi patch sẽ được detect 1 box vì vậy đầu ra của nó sẽ có shape là (2 x 2 x (4 + num_class )), vì vậy khi phải xét head classification ta chỉ cần lấy từ 4:, còn :4 sẽ là tọa độ của mỗi box, còn về việc loại các box như nào vì kiểu ta chỉ detect 2 obj mà có 4 box lận, thì lúc này ta sẽ dùng softmax để lấy ra chỉ số cao nhất và dùng threshold để loại bỏ những cái có threshold nhỏ.Chú ý kết quả của kiểu này cực không ổn nhé.
#### task4: ở task số 4 này đang sử dụng kiến trúc cơ bản nhất của yolo là yolov1 với đầu ra là (7 x 7 x (C + B x 5)), sự khác nhau ở đây đó là về construct của data khi x, y là tâm tọa độ mapping với tọa độ của bounding box đó, và chỉ có cell nào có tâm tọa độ thì mới có giá trị class bằng 1 còn lại tất cả giá trị của các cell không có tâm tọa độ đều là 0 hết và loss ở đây cũng rất đặc biệt nó sẽ có 4 loss: cordinate loss, object loss, no object loss, class loss, nhưng điểm yếu ở đây đó là nó sẽ không xử lí với nhiều object trong cùng 1 cell được, và sau này ở các ver nâng cấp khác nó đã có thuật toán xử lí cho việc này lấy ví dụ đó là Anchor box.
#### Một số key trong object detect: IOU(tính toán diện tích giao/diện tích hợp dùng để loại bỏ những bounding box bị thừa), NMS(thuật toán dựa vào IOU để loại bỏ những bounding box thừa), MAP(là chỉ số dựa vào threshold để tính toán ap cho từng lớp dựa vào precision và recall để từ đó tính toán được map cho tất cả class, chỉ số càng cao thì càng tốt), Anchor box(là sự update của phiên bản yolov2, nó sẽ có nhiều khung cao hẹp, rộng, ... với mỗi khung trong 1 cell sẽ chịu trách nhiệm cho 1 đối tượng giúp cải thiện việc có nhiều object trong 1 cell mà không thể dự đoán được), Multi-scale prediction(thay vì cố định 7 x 7 nó sẽ cho đi qua conv để chia ảnh thành nhiều cell nhỏ từ đó giúp dự đoán được những object có kích cỡ nhỏ).
#### Mẹo khi train với model object detect: sử dụng pin_memory để có thể transfer data lên gpu nhanh hơn, num_worker để nó chia các batch giúp việc xử lí data nhanh hơn.
